<form class="form-horizontal " (ngSubmit)="onSubmit()" [formGroup]="phenomenonForm">
  <div class="panel panel-primary">

    <senph-hero-banner title="Edit Phenomenon:" [subtitle]="heroBannerString + phenomenonForm.get('uri').value">
    </senph-hero-banner>

    <!-- URI -->
    <div class="panel-body">
      <!-- <div class="container well some-space">
        <div class="form-group row" [ngClass]="{'has-error' : formErrors.uri}">
        <label class="col-sm-2 control-label" for="uri">URI</label>
        <div class="field is-horizontal">
          <div class="form-group field-body">
            <div class="field is-grouped">
              <div class="field-label is-normal">
                <label class="label">URI:</label>
              </div>
              <div class="col-sm-8 input-group">
              <div class="control">
                <div class=" input-group">
                  <span class="input-group-addon" id="heroaddon">{{heroBannerString}}</span>
                  <input type="text" id="uri" formControlName="uri" class="form-control" (blur)="logValidationErrors()"
                    aria-describedby="heroaddon">
                </div>
                <span class="help-block" *ngIf="formErrors.uri">
                  {{formErrors.uri}}
                </span>
              </div>
            </div>
          </div>
        </div>
      </div> -->

      <div class="container well some-space">
        <div class="field is-horizontal is-grouped">
          <div class="field-label is-normal">
            <label class="label">URI:</label>
          </div>
          <div class="form-group field-body">
            <div class="field">
              <div class="control">
                <div class=" input-group">
                  <span class="input-group-addon" id="heroaddon">{{heroBannerString}}</span>
                  <input type="text" id="uri" formControlName="uri" class="input is-normal"
                    (blur)="logValidationErrors()" aria-describedby="heroaddon">
                </div>
              </div>
              <span class="help-block" *ngIf="formErrors.description">
                {{formErrors.description}}
              </span>
            </div>
          </div>
        </div>
      </div>



      <div class="container well some-space">
        <label for="label">Labels</label>
        <div formArrayName="label" *ngFor="let dom of phenomenonForm.get('label').controls; let i = index">
          <div [formGroupName]="i">
            <div class="row">
              <div class="col-sm-10">
                <div class="field is-horizontal is-grouped">
                  <div class="form-group field-body">
                    <div class="field is-grouped">
                      <div class="field-label is-normal">
                        <label class="label">Label:</label>
                      </div>
                      <div class="control">
                        <input class="input is-normal" type="text" placeholder="Label" [id]="'labelVal' + i"
                          formControlName="value">
                      </div>
                    </div>
                  </div>
                  <div class="form-group field-body">
                    <div class="field is-grouped">
                      <div class="field-label is-normal">
                        <label class="label">Language:</label>
                      </div>
                      <div class="field is-narrow">
                        <div class="control">
                          <div class="select ">
                            <select [id]="'lang' + i" formControlName="lang">
                              <option value="" [selected]='true'> Choose a language</option>
                              <option *ngFor="let language of languageArray" [ngValue]="language.val">
                                {{language.show}}
                              </option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-2">
                <button class="button is-small is-danger pull-right" (click)="removeLabelButtonClick(i)">
                  <span class="glyphicon glyphicon-remove"></span>
                </button>
              </div>
            </div>
          </div>
        </div>
        <button type="button" class="button is-warning is-inverted" (click)="addLabelButtonClick()"
          [disabled]="phenomenonForm.get('label').invalid">Add Label</button>
      </div>


      <div class="container well some-space">
        <div class="field is-horizontal is-grouped">
          <div class="field-label is-normal">
            <label class="label">Description:</label>
          </div>
          <div class="form-group field-body">
            <div class="field">
              <div class="control">
                <input class="input is-normal" type="text" id="description" formControlName="description"
                  (blur)="logValidationErrors()">
              </div>
              <span class="help-block" *ngIf="formErrors.description">
                {{formErrors.description}}
              </span>
            </div>
          </div>
        </div>

      </div>


      <!-- DESCRIPTION -->
      <!-- <div class="form-group" [ngClass]="{'has-error' : formErrors.description}">
        <label class="col-sm-2 control-label" for="description">Description</label>
        <div class="col-sm-8">
          <input type="text" id="description" formControlName="description" class="form-control"
            (blur)="logValidationErrors()">

        </div>
      </div> -->


      <!-- DOMAINS -->

      <div class="container well some-space">
        <label for="domain">Domains</label>
        <div formArrayName="domain" *ngFor="let dom of phenomenonForm.get('domain').controls; let i = index">
          <div [formGroupName]="i">
            <div class="row">
              <div class="col-sm-10">
                <div class="field is-horizontal">
                  <div class="form-group field-body">
                    <div class="field is-grouped">
                      <div class="field-label is-narrow">
                        <label class="label">Domain:</label>
                      </div>
                      <div class="field is-narrow">
                        <div class="control">
                          <div class="select ">
                            <select [id]="'domainUri' + i" formControlName="domainUri">
                              <option> Choose a domain</option>
                              <option *ngFor="let domain of domainsArray" [ngValue]="domain.domain.value">
                                {{domain.label[0]?.value}}
                              </option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-2">
                <button class="button is-small is-danger pull-right" (click)="removeDomainButtonClick(i)">
                  <span class="glyphicon glyphicon-remove"></span>
                </button>
              </div>
            </div>
          </div>
        </div>
        <button type="button" class="button is-warning is-inverted" (click)="addDomainButtonClick()"
          [disabled]="phenomenonForm.get('domain').invalid">Add Domain</button>
      </div>


      <!-- <div>

        <div class="form-group">
          <div class="col-md-offset-2 col-md-4">
            <button type="button" class="button is-warning is-inverted" (click)="addDomainButtonClick()"
              [disabled]="phenomenonForm.get('domain').invalid">Add Domain</button>
          </div>
        </div>

        <div formArrayName="domain">
          <div *ngFor="let dom of phenomenonForm.get('domain').controls; let i = index">
            <hr *ngIf="i>0">
            <div class="well" [formGroupName]="i">




              <div class="form-group" [ngClass]="{'has-error' : dom.get('domainUri').invalid &&
                                                                dom.get('domainUri').touched }">
                <label class="col-sm-2 control-label" [attr.for]="'domainUri' + i">
                  Domain URI
                </label>
                <div class="col-sm-4">
                  <input type="text" [id]="'domainUri' + i" placeholder="domainName" formControlName="domainUri"
                    class="form-control">
                  <span class="help-block" *ngIf="dom.get('domainUri').errors?.required && 
                                                  dom.get('domainUri').touched ">
                    Domain URI is required
                  </span>
                </div>
                <div class="col-sm-6">
                  <button *ngIf="phenomenonForm.get('domain').length>1" class="button is-small is-danger pull-right"
                    title="Delete domain" (click)="removeDomainButtonClick(i)">
                    <span class="glyphicon glyphicon-remove"></span>
                  </button>
                </div>
              </div>

              <div class="form-group" [ngClass]="{'has-error' : dom.get('domainLabel').invalid &&
                                                                dom.get('domainLabel').touched }">
                <label class="col-sm-2 control-label" [attr.for]="'domainLabel' + i">
                  Domain Name
                </label>
                <div class="col-sm-4">
                  <input type="text" [id]="'domainLabel' + i" placeholder="domainLabel" formControlName="domainLabel"
                    class="form-control">
                  <span class="help-block" *ngIf="dom.get('domainLabel').errors?.required && 
                                                  dom.get('domainLabel').touched ">
                    Domain name is required
                  </span>
                </div>
              </div>

            </div>
          </div>
        </div>
      </div> -->


      <!-- UNITS -->
      <div class="container well some-space">
        <label for="unit">Units</label>
        <div formArrayName="unit" *ngFor="let dom of phenomenonForm.get('unit').controls; let i = index">
          <div [formGroupName]="i">
            <div class="row">
              <div class="col-sm-10">
                <div class="field is-horizontal">
                  <div class="form-group field-body">
                    <div class="field is-grouped">
                      <div class="field-label is-narrow">
                        <label class="label">unit:</label>
                      </div>
                      <div class="field is-narrow">
                        <div class="control">
                          <div class="select ">
                            <select [id]="'unitUri' + i" formControlName="unitUri">
                              <option> Choose a unit</option>
                              <option *ngFor="let unit of unitsArray" [ngValue]="unit.y.value">
                                {{unit.label.value}}
                              </option>
                            </select>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-2">
                <button class="button is-small is-danger pull-right" (click)="removeunitButtonClick(i)">
                  <span class="glyphicon glyphicon-remove"></span>
                </button>
              </div>
            </div>
          </div>
        </div>
        <button type="button" class="button is-warning is-inverted" (click)="addunitButtonClick()"
          [disabled]="phenomenonForm.get('unit').invalid">Add unit</button>
      </div>

      <!-- <div>

        <div class="form-group">
          <div class="col-md-offset-2 col-md-4">
            <button type="button" class="button is-warning is-inverted" (click)="addUnitButtonClick()"
              [disabled]="phenomenonForm.get('unit').invalid">Add Unit</button>
          </div>
        </div>

        <div formArrayName="unit" *ngFor="let uni of phenomenonForm.get('unit').controls; let i = index">
          <hr *ngIf="i>0">
          <div class="well" [formGroupName]="i">

            <div class="form-group" [ngClass]="{'has-error' : uni.get('unitUri').invalid &&
                                                                uni.get('unitUri').touched }">
              <label class="col-sm-2 control-label" [attr.for]="'unitUri' + i">
                Unit URI
              </label>
              <div class="col-sm-4">
                <input type="text" [id]="'unitUri' + i" placeholder="UO Unit Identifier" formControlName="unitUri"
                  class="form-control">
                <span class="help-block" *ngIf="uni.get('unitUri').errors?.required && 
                                                  uni.get('unitUri').touched ">
                  Unit URI is required
                </span>
              </div>
              <div class="col-sm-6">
                <button *ngIf="phenomenonForm.get('unit').length>1" class="button is-small is-danger pull-right"
                  title="Delete Unit" (click)="removeUnitButtonClick(i)">
                  <span class="glyphicon glyphicon-remove"></span>
                </button>
              </div>
            </div>

            <div class="form-group" [ngClass]="{'has-error' : uni.get('unitLabel').invalid &&
                                                                uni.get('unitLabel').touched }">
              <label class="col-sm-2 control-label" [attr.for]="'unitLabel' + i">
                Unit Name
              </label>
              <div class="col-sm-4">
                <input type="text" [id]="'unitLabel' + i" placeholder="Shortcut/Name of Unit"
                  formControlName="unitLabel" class="form-control">
                <span class="help-block" *ngIf="uni.get('unitLabel').errors?.required && 
                                                  uni.get('unitLabel').touched ">
                  Unit name is required
                </span>
              </div>
            </div>

          </div>
        </div>
      </div> -->

    </div>
    <div class="panel-footer">
      <div class="field is-grouped">
        <p class="control">
          <button class="button is-success" type="submit" [disabled]="phenomenonForm.invalid">Save Changes</button>
        </p>
        <p class="control">
          <button class="button is-warning is-inverted" type="button" (click)="onLoadButtonClick()">Load data</button>
        </p>
      </div>
    </div>
  </div>
</form>